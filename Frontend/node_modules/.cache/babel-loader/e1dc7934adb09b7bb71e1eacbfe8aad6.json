{"ast":null,"code":"var _jsxFileName = \"/Users/jugal/Documents/Root/University/Web Dev CS 5610/Project/Front-end/wbdv-sp20-flight-project-client-react/src/components/Profile/ProfileComponent.js\";\nimport React from \"react\";\nimport HeaderComponent from \"../Headers/HeaderComponent\";\nimport { deleteUser, fetchProfile, updateUser } from \"../../services/services\";\nimport './profile-styles.css';\nimport ProfileContentComponent from \"./ProfileContentComponent\";\nimport { TicketComponent } from \"./TicketComponent\";\nimport PasswordModal from \"./PasswordModal\";\nimport crypto from \"crypto-js\";\nexport default class ProfileComponent extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      user: {\n        email: '',\n        first: '',\n        last: '',\n        type: '',\n        ticketsBooked: []\n      },\n      login: false\n    };\n\n    this.deleteAccount = () => {\n      if (window.confirm('Are you sure?')) {\n        // console.log(this.state.user._id)\n        deleteUser(this.state.user._id).then(r => {\n          if (r) {\n            alert(`Your account with ${r.email} has been deleted!`);\n            this.props.history.push('/');\n          }\n        });\n      }\n    };\n\n    this.updateUser = editedValue => {\n      let modifiedUser = Object.assign(this.state.user, editedValue);\n      updateUser(modifiedUser).then(user => {\n        this.setState({\n          user: user\n        });\n      });\n    };\n\n    this.encryptPassword = password => {\n      return crypto.AES.encrypt(JSON.stringify(password), 'DEFcon777').toString();\n    };\n\n    this.updatePassword = password => {\n      window.$('#passwordModal').modal('toggle');\n      console.log(password);\n      let encryptedPassword = this.encryptPassword(password);\n      let updatedUser = this.state.user;\n      updatedUser.password = encryptedPassword;\n      console.log(updatedUser);\n      updateUser(updatedUser).then(user => {\n        this.setState({\n          user: user\n        }, () => alert(\"Password updated successfully!!\"));\n      });\n    };\n  }\n\n  componentDidMount() {\n    fetchProfile().then(user => {\n      if (user) {\n        this.setState({\n          user: user,\n          login: true\n        });\n      } else {\n        this.props.history.push('/');\n      }\n    });\n  }\n\n  render() {\n    let {\n      _id,\n      ticketsBooked,\n      created,\n      ...userDetails\n    } = this.state.user;\n    return React.createElement(React.Fragment, null, React.createElement(HeaderComponent, {\n      user: this.state.user,\n      login: this.state.login,\n      history: this.props.history,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"container container-background\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row pt-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-10\",\n      style: {\n        \"display\": \"inline\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, \"Hello \", this.state.user.first, \"!\")), React.createElement(\"div\", {\n      className: \"col-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-link color-red float-right\",\n      onClick: this.deleteAccount,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, \"Delete Account \", React.createElement(\"i\", {\n      className: \"fas fa-times\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-10\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"Profile type: \", this.state.user.type)), React.createElement(\"div\", {\n      className: \"col-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-success btn-block\",\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#passwordModal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, \"Change Password\"), React.createElement(PasswordModal, {\n      updatePassword: this.updatePassword,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }))), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }), React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, \"My Details:\"), React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, Object.keys(userDetails).map(key => React.createElement(ProfileContentComponent, {\n      key: key,\n      title: key,\n      userDetail: userDetails[key],\n      updateUser: this.updateUser,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }))), this.state.user.ticketsBooked.length !== 0 && React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      className: \"row pt-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, \"Booking History:\"))), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row pl-3 pr-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, this.state.user.ticketsBooked.map(ticket => React.createElement(TicketComponent, {\n      ticket: ticket,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }))))));\n  }\n\n}","map":{"version":3,"sources":["/Users/jugal/Documents/Root/University/Web Dev CS 5610/Project/Front-end/wbdv-sp20-flight-project-client-react/src/components/Profile/ProfileComponent.js"],"names":["React","HeaderComponent","deleteUser","fetchProfile","updateUser","ProfileContentComponent","TicketComponent","PasswordModal","crypto","ProfileComponent","Component","state","user","email","first","last","type","ticketsBooked","login","deleteAccount","window","confirm","_id","then","r","alert","props","history","push","editedValue","modifiedUser","Object","assign","setState","encryptPassword","password","AES","encrypt","JSON","stringify","toString","updatePassword","$","modal","console","log","encryptedPassword","updatedUser","componentDidMount","render","created","userDetails","keys","map","key","length","ticket"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport HeaderComponent from \"../Headers/HeaderComponent\";\nimport {deleteUser, fetchProfile, updateUser} from \"../../services/services\";\nimport './profile-styles.css';\nimport ProfileContentComponent from \"./ProfileContentComponent\";\nimport {TicketComponent} from \"./TicketComponent\";\nimport PasswordModal from \"./PasswordModal\";\nimport crypto from \"crypto-js\";\n\nexport default class ProfileComponent extends React.Component {\n\n  state = {\n    user: {\n      email: '',\n      first: '',\n      last: '',\n      type: '',\n      ticketsBooked: []\n    },\n    login: false\n  };\n\n  componentDidMount() {\n    fetchProfile().then(user => {\n      if (user) {\n        this.setState({\n          user: user,\n          login: true\n        })\n      } else {\n        this.props.history.push('/')\n      }\n    });\n  }\n\n  deleteAccount = () => {\n    if (window.confirm('Are you sure?')) {\n      // console.log(this.state.user._id)\n      deleteUser(this.state.user._id).then(r => {\n        if (r) {\n          alert(`Your account with ${r.email} has been deleted!`);\n          this.props.history.push('/')\n        }\n      })\n    }\n  };\n\n  updateUser = (editedValue) => {\n    let modifiedUser = Object.assign(this.state.user, editedValue);\n    updateUser(modifiedUser).then(user => {\n      this.setState({\n        user: user\n      })\n    })\n  };\n\n  encryptPassword = (password) => {\n    return crypto.AES.encrypt(\n        JSON.stringify(password), 'DEFcon777').toString();\n  };\n\n  updatePassword = (password) => {\n    window.$('#passwordModal').modal('toggle');\n    console.log(password)\n    let encryptedPassword = this.encryptPassword(password);\n    let updatedUser = this.state.user;\n    updatedUser.password = encryptedPassword;\n    console.log(updatedUser)\n    updateUser(updatedUser).then(user => {\n      this.setState({\n        user: user\n      },()=>alert(\"Password updated successfully!!\"))\n    })\n  };\n\n  render() {\n\n    let {_id, ticketsBooked, created, ...userDetails} = this.state.user;\n\n    return (\n        <>\n          <HeaderComponent\n              user={this.state.user}\n              login={this.state.login}\n              history={this.props.history}\n          />\n          <div className='container container-background'>\n            <div className='row pt-3'>\n              <div className='col-10' style={{\"display\": \"inline\"}}>\n                <h2>Hello {this.state.user.first}!</h2>\n              </div>\n              <div className='col-2'>\n                <button className='btn btn-link color-red float-right'\n                        onClick={this.deleteAccount}\n                >Delete\n                  Account <i className=\"fas fa-times\"/></button>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col-10\">\n                <h5>Profile type: {this.state.user.type}</h5>\n              </div>\n              <div className=\"col-2\">\n                <button className=\"btn btn-success btn-block\"\n                        data-toggle=\"modal\"\n                        data-target=\"#passwordModal\">\n                  Change Password\n                </button>\n                <PasswordModal\n                    updatePassword={this.updatePassword}/>\n              </div>\n            </div>\n            <hr/>\n            <h4>My Details:</h4>\n            <div className='row'>\n              {Object.keys(userDetails).map(key =>\n                  <ProfileContentComponent\n                      key={key}\n                      title={key}\n                      userDetail={userDetails[key]}\n                      updateUser={this.updateUser}\n                  />\n              )}\n            </div>\n\n            {this.state.user.ticketsBooked.length !== 0 && <>\n              <div className='row pt-3'>\n                <div className='col-12'>\n                  <h4>Booking History:</h4>\n                </div>\n              </div>\n              <hr/>\n              <div className='row pl-3 pr-3'>\n                {this.state.user.ticketsBooked.map(ticket =>\n                    <TicketComponent\n                        ticket={ticket}/>\n                )}\n              </div>\n            </>}\n          </div>\n        </>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}